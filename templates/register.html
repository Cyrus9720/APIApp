<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<section class="auth-page wave-page">
    <!-- Wave background - GOTTA BE UP HERE -->
    <div class="wave">
        <span></span>
        <span></span>
        <span></span>
    </div>

    <!-- Register card -->
    <div class="container">
        <div class="auth-card">
            <h1 class="auth-title">Create account</h1>
            <p class="auth-subtitle">Make an account to start building your movie list.</p>

            {% if error %}
                <p class="error-message">{{ error }}</p>
            {% endif %}

            <form method="post" class="auth-form">
                <label class="auth-label">
                    Username
                    <input type="text" name="username" placeholder="Choose a username">
                </label>

                <label class="auth-label">
                    Password
                    <input type="password" name="password" placeholder="Choose a password">
                </label>

                <label class="auth-label">
                    Confirm password
                    <input type="password" name="confirm" placeholder="Repeat password">
                </label>

                <button type="submit" class="primary-button full-width">
                    Create account
                </button>
            </form>

            <p class="auth-footer">
                Already have an account?
                <a href="/">Login here</a>.
            </p>
        </div>
    </div>
</section>

<script>
document.querySelector('.auth-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;
    const formData = new FormData(form);
    
    const password = formData.get('password');
    const confirm = formData.get('confirm');
    
    if (password !== confirm) {
        alert('Passwords do not match');
        return;
    }
    
    try {
        const response = await fetch('/api/register', {
            method: 'POST',
            body: formData
        });
        
        if (response.ok) {
            window.location.href = '/movies';
        } else {
            const data = await response.json();
            alert(data.detail || 'Registration failed');
        }
    } catch (err) {
        alert('Network error');
    }
});
</script>
</body>
</html>

